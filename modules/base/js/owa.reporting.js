/*! For license information please see owa.reporting.js.LICENSE.txt */
!function(t){var e={};function i(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(r,o,function(e){return t[e]}.bind(null,o));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/",i(i.s=3)}([function(t,e){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r={items:{},hooks:{actions:{},filters:{}},loadedJsLibs:{},overlay:"",config:{ns:"owa_",baseUrl:"",hashCookiesToDomain:!0,debug:!1},state:{},overlayActive:!1,setSetting:function(t,e){return this.setOption(t,e)},getSetting:function(t){return this.getOption(t)},setOption:function(t,e){this.config[t]=e},getOption:function(t){return this.config[t]},l:function(t){return t},requireJs:function(t,e,i){this.isJsLoaded(t)||r.util.loadScript(e,i),this.loadedJsLibs[t]=e},isJsLoaded:function(t){if(this.loadedJsLibs.hasOwnProperty(t))return!0},initializeStateManager:function(){this.state.hasOwnProperty("init")||(r.debug("initializing state manager..."),this.state=new r.stateManager)},registerStateStore:function(t,e,i,r){return this.initializeStateManager(),this.state.registerStore(t,e,i,r)},checkForState:function(t){return this.initializeStateManager(),this.state.isPresent(t)},setState:function(t,e,i,r,o,s){return this.initializeStateManager(),this.state.set(t,e,i,r,o,s)},replaceState:function(t,e,i,r,o){return this.initializeStateManager(),this.state.replaceStore(t,e,i,r,o)},getStateFromCookie:function(t){return this.initializeStateManager(),this.state.getStateFromCookie(t)},getState:function(t,e){return this.initializeStateManager(),this.state.get(t,e)},clearState:function(t,e){return this.initializeStateManager(),this.state.clear(t,e)},getStateStoreFormat:function(t){return this.initializeStateManager(),this.state.getStoreFormat(t)},setStateStoreFormat:function(t,e){return this.initializeStateManager(),this.state.setStoreFormat(t,e)},debug:function(){var t=r.getSetting("debug")||!1;t&&window.console&&console.log.apply&&(window.console.firebug?console.log.apply(this,arguments):console.log.apply(console,arguments))},setApiEndpoint:function(t){this.config.rest_api_endpoint=t},getApiEndpoint:function(){return this.config.rest_api_endpoint||this.getSetting("baseUrl")+"api/"},loadHeatmap:function(t){var e=this;r.util.loadScript(r.getSetting("baseUrl")+"/modules/base/js/includes/jquery/jquery-1.6.4.min.js",(function(){})),r.util.loadCss(r.getSetting("baseUrl")+"/modules/base/css/owa.overlay.css",(function(){})),r.util.loadScript(r.getSetting("baseUrl")+"/modules/base/js/owa.heatmap.js",(function(){e.overlay=new r.heatmap,e.overlay.options.liveMode=!0,e.overlay.generate()}))},loadPlayer:function(){var t=this;r.debug("Loading Domstream Player"),r.util.loadScript(r.getSetting("baseUrl")+"/modules/base/js/includes/jquery/jquery-1.6.4.min.js",(function(){})),r.util.loadCss(r.getSetting("baseUrl")+"/modules/base/css/owa.overlay.css",(function(){})),r.util.loadScript(r.getSetting("baseUrl")+"/modules/base/js/owa.player.js",(function(){t.overlay=new r.player}))},startOverlaySession:function(t){r.overlayActive=!0,t.hasOwnProperty("api_url")&&r.setApiEndpoint(t.api_url);var e=t;"loadHeatmap"===e.action?this.loadHeatmap(t):"loadPlayer"===e.action&&this.loadPlayer(t)},endOverlaySession:function(){r.util.eraseCookie(r.getSetting("ns")+"overlay",document.domain),r.overlayActive=!1},addFilter:function(t,e,i){void 0===i&&(i=10),this.hooks.filters[t]=this.hooks.filters[t]||[],this.hooks.filters[t].push({priority:i,callback:e})},addAction:function(t,e,i){r.debug("Adding Action callback for: "+t),void 0===i&&(i=10),this.hooks.actions[t]=this.hooks.actions[t]||[],this.hooks.actions[t].push({priority:i,callback:e})},applyFilters:function(t,e,i){r.debug("Filtering "+t+" with value:"),r.debug(e);var o=[];return void 0!==this.hooks.filters[t]&&this.hooks.filters[t].length>0&&(r.debug("Applying filters for "+t),this.hooks.filters[t].forEach((function(t){o[t.priority]=o[t.priority]||[],o[t.priority].push(t.callback)})),o.forEach((function(t){t.forEach((function(t){e=t(e,i),r.debug("Filter returned value: "),r.debug(e)}))}))),e},doAction:function(t,e){r.debug("Doing Action: "+t);var i=[];void 0!==this.hooks.actions[t]&&this.hooks.actions[t].length>0&&(r.debug(this.hooks.actions[t]),this.hooks.actions[t].forEach((function(t){i[t.priority]=i[t.priority]||[],i[t.priority].push(t.callback)})),i.forEach((function(i){r.debug("Executing Action callabck for: "+t),i.forEach((function(t){t(e)}))})))},removeAction:function(t,e){this.hooks.actions[t]=this.hooks.actions[t]||[],this.hooks.actions[t].forEach((function(i,r){i.callback===e&&this.hooks.actions[t].splice(r,1)}))},removeFilter:function(t,e){this.hooks.filters[t]=this.hooks.filters[t]||[],this.hooks.filters[t].forEach((function(e,i){e.callback===callback&&this.hooks.filters[t].splice(i,1)}))},stateManager:function(){this.cookies=r.util.readAllCookies(),this.init=!0}};r.stateManager.prototype={init:!1,cookies:"",stores:{},storeFormats:{},storeMeta:{},registerStore:function(t,e,i,r){this.storeMeta[t]={expiration:e,length:i,format:r}},getExpirationDays:function(t){if(this.storeMeta.hasOwnProperty(t))return this.storeMeta[t].expiration},getFormat:function(t){if(this.storeMeta.hasOwnProperty(t))return this.storeMeta[t].format},isPresent:function(t){if(this.stores.hasOwnProperty(t))return!0},set:function(t,e,i,o,s,n){this.isPresent(t)||this.load(t),this.isPresent(t)||(r.debug("Creating state store (%s)",t),this.stores[t]={},r.getSetting("hashCookiesToDomain")&&(this.stores[t].cdh=r.util.getCookieDomainHash(r.getSetting("cookie_domain")))),e?this.stores[t][e]=i:this.stores[t]=i,(s=this.getFormat(t))||this.storeFormats.hasOwnProperty(t)&&(s=this.storeFormats[t]);var a="";a="json"===s?JSON.stringify(this.stores[t]):r.util.assocStringFromJson(this.stores[t]),(n=this.getExpirationDays(t))||o&&(n=364),r.debug("Populating state store (%s) with value: %s",t,a);var u=r.getSetting("cookie_domain")||document.domain;r.util.setCookie(r.getSetting("ns")+t,a,n,"/",u)},replaceStore:function(t,e,i,o,s){if(r.debug("replace state format: %s, value: %s",o,JSON.stringify(e)),t){e&&(o=this.getFormat(t),this.stores[t]=e,this.storeFormats[t]=o,cookie_value="json"===o?JSON.stringify(e):r.util.assocStringFromJson(e));var n=r.getSetting("cookie_domain")||document.domain;s=this.getExpirationDays(t),r.debug("About to replace state store (%s) with: %s",t,cookie_value),r.util.setCookie(r.getSetting("ns")+t,cookie_value,s,"/",n)}},getStateFromCookie:function(t){var e=unescape(r.util.readCookie(r.getSetting("ns")+t));if(e)return e},get:function(t,e){return this.isPresent(t)||this.load(t),this.isPresent(t)?e?this.stores[t].hasOwnProperty(e)?this.stores[t][e]:void 0:this.stores[t]:(r.debug("No state store (%s) was found",t),"")},getCookieValues:function(t){if(this.cookies.hasOwnProperty(t))return this.cookies[t]},load:function(t){var e="",i=this.getCookieValues(r.getSetting("ns")+t);if(i)for(var o=0;o<i.length;o++){var s=unescape(i[o]),n=r.util.decodeCookieValue(s),a=r.util.getCookieValueFormat(s);if(r.getSetting("hashCookiesToDomain")){var u=r.getSetting("cookie_domain"),l=r.util.getCookieDomainHash(u);if(n.hasOwnProperty("cdh")){if(r.debug("Cookie value cdh: %s, domain hash: %s",n.cdh,l),n.cdh==l){r.debug("Cookie: %s, index: %s domain hash matches current cookie domain. Loading...",t,o),e=n;break}r.debug("Cookie: %s, index: %s domain hash does not match current cookie domain. Not loading.",t,o)}else r.debug("Cookie: %s, index: %s has no domain hash. Not going to Load it.",t,o)}else{o===i.length-1&&(e=n)}}e?(this.stores[t]=e,this.storeFormats[t]=a,r.debug("Loaded state store: %s with: %s",t,JSON.stringify(e))):r.debug("No state for store: %s was found. Nothing to Load.",t)},clear:function(t,e){if(e){var i=this.get(t);i&&i.hasOwnProperty(e)&&(delete i.key,this.replaceStore(t,i,!0,this.getFormat(t),this.getExpirationDays(t)))}else delete this.stores[t],r.util.eraseCookie(r.getSetting("ns")+t),this.cookies=r.util.readAllCookies()},getStoreFormat:function(t){return this.getFormat(t)},setStoreFormat:function(t,e){this.storeFormats[t]=e}},r.uri=function(t){this.components={},this.dirty=!1,this.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},t&&(this.components=this.parseUri(t))},r.uri.prototype={parseUri:function(t){for(var e=this.options,i=e.parser[e.strictMode?"strict":"loose"].exec(t),r={},o=14;o--;)r[e.key[o]]=i[o]||"";return r[e.q.name]={},r[e.key[12]].replace(e.q.parser,(function(t,i,o){i&&(r[e.q.name][i]=o)})),r},getHost:function(){if(this.components.hasOwnProperty("host"))return this.components.host},getQueryParam:function(t){if(this.components.hasOwnProperty("queryKey")&&this.components.queryKey.hasOwnProperty(t))return r.util.urldecode(this.components.queryKey[t])},isQueryParam:function(t){return!(!this.components.hasOwnProperty("queryKey")||!this.components.queryKey.hasOwnProperty(t))},getComponent:function(t){if(this.components.hasOwnProperty(t))return this.components[t]},getProtocol:function(){return this.getComponent("protocol")},getAnchor:function(){return this.getComponent("anchor")},getQuery:function(){return this.getComponent("query")},getFile:function(){return this.getComponent("file")},getRelative:function(){return this.getComponent("relative")},getDirectory:function(){return this.getComponent("directory")},getPath:function(){return this.getComponent("path")},getPort:function(){return this.getComponent("port")},getPassword:function(){return this.getComponent("password")},getUser:function(){return this.getComponent("user")},getUserInfo:function(){return this.getComponent("userInfo")},getQueryParams:function(){return this.getComponent("queryKey")},getSource:function(){return this.getComponent("source")},setQueryParam:function(t,e){this.components.hasOwnProperty("queryKey")||(this.components.queryKey={}),this.components.queryKey[t]=r.util.urlEncode(e),this.resetQuery()},removeQueryParam:function(t){this.components.hasOwnProperty("queryKey")&&this.components.queryKey.hasOwnProperty(t)&&(delete this.components.queryKey[t],this.resetQuery())},resetSource:function(){this.components.source=this.assembleUrl()},resetQuery:function(){var t=this.getQueryParams();if(t){var e="",i=r.util.countObjectProperties(t);for(var o in t)e+=o+"="+t[o],1<i&&(e+="&");this.components.query=e,this.resetSource()}},isDirty:function(){return this.dirty},setPath:function(t){},assembleUrl:function(){var t="";t+=this.getProtocol(),t+="://",this.getUser()&&(t+=this.getUser()),this.getUser()&&this.getPassword()&&(t+=":"+this.password()),t+=this.getHost(),this.getPort()&&(t+=":"+this.getPort()),t+=this.getDirectory(),t+=this.getFile();var e=this.getQuery();e&&(t+="?"+e);var i=this.getAnchor();return i&&(t+="#"+i),t+=this.getAnchor()}},r.util={ns:function(t){return r.config.ns+t},nsAll:function(t){var e=new Object;for(param in t)t.hasOwnProperty(param)&&(e[r.config.ns+param]=t[param]);return e},getScript:function(t,e){jQuery.getScript(e+t)},makeUrl:function(t,e,i){return jQuery.sprintf(t,e,jQuery.param(r.util.nsAll(i)))},createCookie:function(t,e,i,r){if(i){var o=new Date;o.setTime(o.getTime()+24*i*60*60*1e3);var s="; expires="+o.toGMTString()}else s="";document.cookie=t+"="+e+s+"; path=/"},setCookie:function(t,e,i,r,o,s){var n=new Date;n.setTime(n.getTime()+24*i*60*60*1e3),document.cookie=t+"="+escape(e)+(i?"; expires="+n.toGMTString():"")+(r?"; path="+r:"")+(o?"; domain="+o:"")+(s?"; secure":"")},readAllCookies:function(){r.debug("Reading all cookies...");var t={},e=document.cookie.split(";");if(e){r.debug(document.cookie);for(var i=0;i<e.length;i++){var o=r.util.trim(e[i]),s=r.util.strpos(o,"="),n=o.substring(0,s),a=o.substring(s+1,o.length);t.hasOwnProperty(n)||(t[n]=[]),t[n].push(a)}return r.debug(JSON.stringify(t)),t}},readCookie:function(t){r.debug("Attempting to read cookie: %s",t);var e=r.util.readAllCookies();if(e)return e.hasOwnProperty(t)?e[t]:""},eraseCookie:function(t,e){if(r.debug(document.cookie),e||(e=r.getSetting("cookie_domain")||document.domain),r.debug("erasing cookie: "+t+" in domain: "+e),this.setCookie(t,"",-1,"/",e),r.util.readCookie(t)){var i=e.substr(0,1);if(r.debug("period: "+i),"."===i){var o=e.substr(1);r.debug("erasing "+t+" in domain2: "+o),this.setCookie(t,"",-2,"/",o)}else r.debug("erasing "+t+" in domain3: "+e),this.setCookie(t,"",-2,"/",e)}},eraseMultipleCookies:function(t,e){for(var i=0;i<t.length;i++)this.eraseCookie(t[i],e)},loadScript:function(t,e){var i=document.createElement("script");i.type="text/javascript",i.readyState?i.onreadystatechange=function(){"loaded"!=i.readyState&&"complete"!=i.readyState||(i.onreadystatechange=null,e())}:i.onload=function(){e&&e()},i.src=t,document.getElementsByTagName("head")[0].appendChild(i)},loadCss:function(t,e){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.href=t,document.getElementsByTagName("HEAD")[0].appendChild(i)},parseCookieString:function(t){var e=new Array,i=unescape(t).split("|||");for(var r in i)if(i.hasOwnProperty(r)){var o=i[r].split("=>");e[o[0]]=o[1]}return e},parseCookieStringToJson:function(t){var e=new Object,i=unescape(t).split("|||");for(var r in i)if(i.hasOwnProperty(r)){var o=i[r].split("=>");e[o[0]]=o[1]}return e},nsParams:function(t){var e=new Object;for(param in t)t.hasOwnProperty(param)&&(e[r.getSetting("ns")+param]=t[param]);return e},urlEncode:function(t){return t=(t+"").toString(),encodeURIComponent(t).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},urldecode:function(t){return decodeURIComponent(t.replace(/\+/g,"%20"))},parseUrlParams:function(t){for(var e,i,r,o,s,n,a={},u=location.href.split(/[?&]/),l=u.length,h=1;h<l;h++)if((r=u[h].match(/(.*?)(\..*?|\[.*?\])?=([^#]*)/))&&4==r.length){if(o=decodeURI(r[1]).toLowerCase(),s=a,n=decodeURI(r[3]),r[2])for(i=decodeURI(r[2]).replace(/\[\s*\]/g,"[-1]").split(/[\.\[\]]/),e=0;e<i.length;e++)s=s[o]?s[o]:s[o]=parseInt(i[e])==i[e]?[]:{},o=i[e].replace(/^["\'](.*)["\']$/,"$1");"-1"!=o?s[o]=n:s[s.length]=n}return a},strpos:function(t,e,i){var r=(t+"").indexOf(e,i||0);return-1!==r&&r},strCountOccurances:function(t,e){return t.split(e).length-1},implode:function(t,e){var r="",o="",s="";if(1===arguments.length&&(e=t,t=""),"object"===i(e)){if(e instanceof Array)return e.join(t);for(r in e)o+=s+e[r],s=t;return o}return e},checkForState:function(t){return r.checkForState(t)},setState:function(t,e,i,o,s,n){return r.setState(t,e,i,o,s,n)},replaceState:function(t,e,i,o,s){return r.replaceState(t,e,i,o,s)},getRawState:function(t){return r.getStateFromCookie(t)},getState:function(t,e){return r.getState(t,e)},clearState:function(t,e){return r.clearState(t,e)},getCookieValueFormat:function(t){return"{"===t.substr(0,1)?"json":"assoc"},decodeCookieValue:function(t){var e=r.util.getCookieValueFormat(t),i="";return i="json"===e?JSON.parse(t):r.util.jsonFromAssocString(t),r.debug("decodeCookieValue - string: %s, format: %s, value: %s",t,e,JSON.stringify(i)),i},encodeJsonForCookie:function(t,e){return"json"===(e=e||"assoc")?JSON.stringify(t):r.util.assocStringFromJson(t)},getCookieDomainHash:function(t){return r.util.dechex(r.util.crc32(t))},loadStateJson:function(t){var e=unescape(r.util.readCookie(r.getSetting("ns")+t));e&&(state=JSON.parse(e)),r.state[t]=state,r.debug("state store %s: %s",t,JSON.stringify(state))},is_array:function(t){return"object"==i(t)&&t instanceof Array},str_pad:function(t,e,i,r){var o,s="",n=function(t,e){for(var i="";i.length<e;)i+=t;return i=i.substr(0,e)};return i=void 0!==i?i:" ","STR_PAD_LEFT"!=r&&"STR_PAD_RIGHT"!=r&&"STR_PAD_BOTH"!=r&&(r="STR_PAD_RIGHT"),(o=e-(t+="").length)>0&&("STR_PAD_LEFT"==r?t=n(i,o)+t:"STR_PAD_RIGHT"==r?t+=n(i,o):"STR_PAD_BOTH"==r&&(t=(t=(s=n(i,Math.ceil(o/2)))+t+s).substr(0,e))),t},zeroFill:function(t,e){return r.util.str_pad(t,e,"0","STR_PAD_LEFT")},is_object:function(t){return!(t instanceof Array)&&(null!==t&&"object"==i(t))},countObjectProperties:function(t){var e,i=0;for(e in t)t.hasOwnProperty(e)&&i++;return i},jsonFromAssocString:function(t,e,i){if(e=e||"=>",i=i||"|||",t){if(!this.strpos(t,e))return t;for(var r={},o=t.split(i),s=0,n=o.length;s<n;s++){var a=o[s].split(e);r[a[0]]=a[1]}return r}},assocStringFromJson:function(t){var e="",i=0,o=r.util.countObjectProperties(t);for(var s in t)i++,e+=s+"=>"+t[s],i<o&&(e+="|||");return e},getDomainFromUrl:function(t,e){var i=t.split(/\/+/g)[1];return!0===e?r.util.stripWwwFromDomain(i):i},stripWwwFromDomain:function(t){return"www"===t.split(".")[0]?t.substring(4):t},getCurrentUnixTimestamp:function(){return Math.round((new Date).getTime()/1e3)},generateHash:function(t){return this.crc32(t)},generateRandomGuid:function(){return this.getCurrentUnixTimestamp()+""+r.util.zeroFill(this.rand(0,999999)+"",6)+r.util.zeroFill(this.rand(0,999)+"",3)},crc32:function(t){var e=0,i=0;e^=-1;for(var r=0,o=(t=this.utf8_encode(t)).length;r<o;r++)i=255&(e^t.charCodeAt(r)),e=e>>>8^"0x"+"00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D".substr(9*i,8);return-1^e},utf8_encode:function(t){var e,i,r,o=t+"",s="";e=i=0,r=o.length;for(var n=0;n<r;n++){var a=o.charCodeAt(n),u=null;a<128?i++:u=a>127&&a<2048?String.fromCharCode(a>>6|192)+String.fromCharCode(63&a|128):String.fromCharCode(a>>12|224)+String.fromCharCode(a>>6&63|128)+String.fromCharCode(63&a|128),null!==u&&(i>e&&(s+=o.substring(e,i)),s+=u,e=i=n+1)}return i>e&&(s+=o.substring(e,o.length)),s},utf8_decode:function(t){var e=[],i=0,r=0,o=0,s=0,n=0;for(t+="";i<t.length;)(o=t.charCodeAt(i))<128?(e[r++]=String.fromCharCode(o),i++):o>191&&o<224?(s=t.charCodeAt(i+1),e[r++]=String.fromCharCode((31&o)<<6|63&s),i+=2):(s=t.charCodeAt(i+1),n=t.charCodeAt(i+2),e[r++]=String.fromCharCode((15&o)<<12|(63&s)<<6|63&n),i+=3);return e.join("")},trim:function(t,e){var i,r=0,o=0;for(t+="",i=e?(e+="").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1"):" \n\r\t\f\v            ​\u2028\u2029　",r=t.length,o=0;o<r;o++)if(-1===i.indexOf(t.charAt(o))){t=t.substring(o);break}for(o=(r=t.length)-1;o>=0;o--)if(-1===i.indexOf(t.charAt(o))){t=t.substring(0,o+1);break}return-1===i.indexOf(t.charAt(0))?t:""},rand:function(t,e){var i=arguments.length;if(0===i)t=0,e=2147483647;else if(1===i)throw new Error("Warning: rand() expects exactly 2 parameters, 1 given");return Math.floor(Math.random()*(e-t+1))+t},base64_encode:function(t){var e,i,r,o,s,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=0,u=0,l="",h=[];if(!t)return t;t=this.utf8_encode(t+"");do{e=(s=t.charCodeAt(a++)<<16|t.charCodeAt(a++)<<8|t.charCodeAt(a++))>>18&63,i=s>>12&63,r=s>>6&63,o=63&s,h[u++]=n.charAt(e)+n.charAt(i)+n.charAt(r)+n.charAt(o)}while(a<t.length);switch(l=h.join(""),t.length%3){case 1:l=l.slice(0,-2)+"==";break;case 2:l=l.slice(0,-1)+"="}return l},base64_decode:function(t){var e,i,r,o,s,n,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=0,l=0,h="",d=[];if(!t)return t;t+="";do{e=(n=a.indexOf(t.charAt(u++))<<18|a.indexOf(t.charAt(u++))<<12|(o=a.indexOf(t.charAt(u++)))<<6|(s=a.indexOf(t.charAt(u++))))>>16&255,i=n>>8&255,r=255&n,d[l++]=64==o?String.fromCharCode(e):64==s?String.fromCharCode(e,i):String.fromCharCode(e,i,r)}while(u<t.length);return h=d.join(""),h=this.utf8_decode(h)},sprintf:function(){var t=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuidfegEG])/g,e=arguments,i=0,r=e[i++],o=function(t,e,i,r){i||(i=" ");var o=t.length>=e?"":Array(1+e-t.length>>>0).join(i);return r?t+o:o+t},s=function(t,e,i,r,s,n){var a=r-t.length;return a>0&&(t=i||!s?o(t,r,n,i):t.slice(0,e.length)+o("",a,"0",!0)+t.slice(e.length)),t},n=function(t,e,i,r,n,a,u){var l=t>>>0;return t=(i=i&&l&&{2:"0b",8:"0",16:"0x"}[e]||"")+o(l.toString(e),a||0,"0",!1),s(t,i,r,n,u)},a=function(t,e,i,r,o,n){return null!=r&&(t=t.slice(0,r)),s(t,"",e,i,o,n)},u=function(t,r,u,l,h,d,c){var p,f,m,g,y;if("%%"==t)return"%";for(var w=!1,v="",b=!1,_=!1,C=" ",D=u.length,A=0;u&&A<D;A++)switch(u.charAt(A)){case" ":v=" ";break;case"+":v="+";break;case"-":w=!0;break;case"'":C=u.charAt(A+1);break;case"0":b=!0;break;case"#":_=!0}if((l=l?"*"==l?+e[i++]:"*"==l.charAt(0)?+e[l.slice(1,-1)]:+l:0)<0&&(l=-l,w=!0),!isFinite(l))throw new Error("sprintf: (minimum-)width must be finite");switch(d=d?"*"==d?+e[i++]:"*"==d.charAt(0)?+e[d.slice(1,-1)]:+d:"fFeE".indexOf(c)>-1?6:"d"==c?0:void 0,y=r?e[r.slice(0,-1)]:e[i++],c){case"s":return a(String(y),w,l,d,b,C);case"c":return a(String.fromCharCode(+y),w,l,d,b);case"b":return n(y,2,_,w,l,d,b);case"o":return n(y,8,_,w,l,d,b);case"x":return n(y,16,_,w,l,d,b);case"X":return n(y,16,_,w,l,d,b).toUpperCase();case"u":return n(y,10,_,w,l,d,b);case"i":case"d":return y=(f=(p=parseInt(+y,10))<0?"-":v)+o(String(Math.abs(p)),d,"0",!1),s(y,f,w,l,b);case"e":case"E":case"f":case"F":case"g":case"G":return f=(p=+y)<0?"-":v,m=["toExponential","toFixed","toPrecision"]["efg".indexOf(c.toLowerCase())],g=["toString","toUpperCase"]["eEfFgG".indexOf(c)%2],y=f+Math.abs(p)[m](d),s(y,f,w,l,b)[g]();default:return t}};return r.replace(t,u)},clone:function(t){var e=t instanceof Array?[]:{};for(var o in t)t[o]&&"object"==i(t[o])?e[o]=r.util.clone(t[o]):e[o]=t[o];return e},strtolower:function(t){return(t+"").toLowerCase()},in_array:function(t,e,i){var r="";if(!!i){for(r in e)if(e[r]===t)return!0}else for(r in e)if(e[r]==t)return!0;return!1},dechex:function(t){return t<0&&(t=4294967295+t+1),parseInt(t,10).toString(16)},explode:function(t,e,r){var o={0:""};if(arguments.length<2||void 0===arguments[0]||void 0===arguments[1])return null;if(""===t||!1===t||null===t)return!1;if("function"==typeof t||"object"==i(t)||"function"==typeof e||"object"==i(e))return o;if(!0===t&&(t="1"),r){var s=e.toString().split(t.toString()),n=s.splice(0,r-1),a=s.join(t.toString());return n.push(a),n}return e.toString().split(t.toString())},isIE:function(){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent))return!0},getInternetExplorerVersion:function(){var t=-1;if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1))}return t},isBrowserTrackable:function(){for(var t=["doNotTrack","msDoNotTrack"],e=0,i=t.length;e<i;e++)if(navigator[t[e]]&&"1"==navigator[t[e]])return!1;return!0}},window.OWA=r},,,function(t,e,i){i(0),i(4),i(5),i(6),i(7),i(8),t.exports=i(9)},function(t,e){OWA.report=function(t,e){this.options={autoRefreshResultSets:!1,autoRefreshResultSetsInterval:15e3},this.overrideOptions(e),this.dom_id=t,this.config=OWA.config,this.properties={},this.tabs={},this.timePeriodControl="",this.resultSetExplorers={},this.isActive=!1,this.activeTab="";this.getOption("autoRefreshResultSets")},OWA.report.prototype={display:function(){},showAutoRefreshControl:function(t){var e="";e=t.hasOwnProperty("target")?t.target:"#"+this.dom_id+" > .liveViewSwitch",t.hasOwnProperty("label")?label=t.label:e="Live View: ";var i=[];i.push('<div class="autoRefreshControl">'),i.push(OWA.util.sprintf('<span class="label">%s</span>',label)),i.push('<span class="buttons">'),i.push('<input type="radio" name="autorefresh" id="autorefresh-on-button" /><label for="autorefresh-on-button">On</label>'),i.push('<input type="radio" name="autorefresh" checked="checked" id="autorefresh-off-button" /><label for="autorefresh-off-button">Off</label>'),i.push("</span>"),i.push('<div style="clear:both;"></div>'),i.push("</div>"),jQuery(e).append(i.join(" ")),jQuery(e+" > .autoRefreshControl > .buttons").buttonset();var r=this;jQuery(e+" > .autoRefreshControl > .buttons > #autorefresh-on-button").click((function(){r.startAutoRefresh()})),jQuery(e+" > .autoRefreshControl > .buttons > #autorefresh-off-button").click((function(){r.stopAutoRefresh()})),jQuery(window).focus((function(){r.isActive=!0,r.getOption("autoRefreshResultSets")&&r.startAutoRefresh()})),jQuery(window).blur((function(){r.isActive=!1,r.getOption("autoRefreshResultSets")&&r.pauseAutoRefresh()}))},startAutoRefresh:function(){var t=this.getOption("autoRefreshResultSetsInterval");if(OWA.util.countObjectProperties(this.resultSetExplorers)>0)for(name in this.resultSetExplorers)this.resultSetExplorers.hasOwnProperty(name)&&this.resultSetExplorers[name].enableAutoRefresh(t);this.activeTab&&this.tabs[this.activeTab].startAutoRefresh(),this.options.autoRefreshResultSets=!0},stopAutoRefresh:function(){if(OWA.util.countObjectProperties(this.resultSetExplorers)>0)for(name in this.resultSetExplorers)this.resultSetExplorers.hasOwnProperty(name)&&this.resultSetExplorers[name].stopAutoRefresh();this.activeTab&&this.tabs[this.activeTab].stopAutoRefresh(),this.options.autoRefreshResultSets=!1},pauseAutoRefresh:function(){this.stopAutoRefresh(),this.options.autoRefreshResultSets=!0},registerResultSetExplorer:function(t,e){this.getOption("autoRefreshResultSets")&&e.enableAutoRefresh(this.getOption("autoRefreshResultSetsInterval")),this.resultSetExplorers[t]=e},overrideOptions:function(t){for(option in t=t||{})t.hasOwnProperty(option)&&(this.options[option]=t[option])},getOption:function(t){if(this.options.hasOwnProperty(t))return this.options[t]},config:"",displayTimePeriodPicker:function(t){var e=this;t=t||"#owa_reportPeriodLabelContainer",this.timePeriodControl||(this.timePeriodControl=new OWA.report.timePeriodControl(t,{startDate:this.getStartDate(),endDate:this.getEndDate(),selectedPeriod:this.getProperty("period")}),jQuery(t).bind("owa_new_time_period_set",(function(t,i,r){e.setDateRange(i,r),e.reload()})),jQuery(t).bind("owa_new_fixed_time_period_set",(function(t,i){e.reportSetTimePeriod(i)})))},showSiteFilter:function(t){var e=this;jQuery("#owa_reportSiteFilterSelect").change((function(){e.reload()}))},reportSetTimePeriod:function(t){this.setPeriod(t),this.reload()},reload:function(){var t=jQuery("#owa_reportSiteFilterSelect option:selected").val();OWA.debug(this.properties.action),null!=t&&(this.properties.siteId=t);var e=OWA.util.makeUrl(OWA.config.link_template,OWA.config.main_url,this.properties);window.location.href=e},_parseDate:function(t){},setDateRange:function(t,e){this.setProperty("startDate",t),this.setProperty("endDate",e),this.removeProperty("period")},setPeriod:function(t){this.properties.period=t,this.properties.hasOwnProperty("startDate")&&delete this.properties.startDate,this.properties.hasOwnProperty("endDate")&&delete this.properties.endDate},addTab:function(t){t.dom_id.length>0?this.tabs[t.dom_id]=t:OWA.debug("tab cannot be added with no dom_id set.")},createTabs:function(){var t=this;for(tab in jQuery("#report-tabs").prepend('<ul class="report-tabs-nav-list"></ul>'),this.tabs)this.tabs.hasOwnProperty(tab)&&jQuery("#report-tabs > .report-tabs-nav-list").append(OWA.util.sprintf('<li><a href="#%s">%s</a></li>',tab,t.tabs[tab].label));jQuery("#report-tabs").tabs({show:function(e,i){OWA.debug("tab selected is: %s",i.panel.id),t.tabs[i.panel.id].load(),t.activeTab&&t.getOption("autoRefreshResultSets")&&t.tabs[t.activeTab].stopAutoRefresh(),t.activeTab=i.panel.id,t.activeTab&&t.getOption("autoRefreshResultSets")&&t.tabs[t.activeTab].startAutoRefresh()}})},getSiteId:function(){return this.getProperty("siteId")},getPeriod:function(){return this.getProperty("period")},getStartDate:function(){return this.getProperty("startDate")},getEndDate:function(){return this.getProperty("endDate")},setRequestProperty:function(t,e){this.setProperty(t,e)},setProperty:function(t,e){this.properties[t]=e},removeProperty:function(t){this.properties.hasOwnProperty(t)&&delete this.properties[t]},getProperty:function(t){if(this.properties.hasOwnProperty(t))return this.properties[t]}},OWA.report.tab=function(t){this.dom_id=t,this.resultSetExplorers={},this.label="Default label",this.isLoaded=!1,this.load=function(){if(!this.isLoaded){for(rse in this.resultSetExplorers)this.resultSetExplorers.hasOwnProperty(rse)&&this.resultSetExplorers[rse].load();this.isLoaded=!0}}},OWA.report.tab.prototype={startAutoRefresh:function(){for(rse in this.resultSetExplorers)this.resultSetExplorers.hasOwnProperty(rse)&&this.resultSetExplorers[rse].enableAutoRefresh()},stopAutoRefresh:function(){for(rse in this.resultSetExplorers)this.resultSetExplorers.hasOwnProperty(rse)&&this.resultSetExplorers[rse].stopAutoRefresh()},addRse:function(t,e){this.resultSetExplorers[t]=e},setLabel:function(t){this.label=t},setDomId:function(t){this.dom_id=t}},OWA.report.timePeriodControl=function(t,e){e=e||{};this.dom_id=t||"owa_reportPeriodControl",this.startDate="",this.endDate="",this.label="",e.hasOwnProperty("startDate")&&this.setStartDate(e.startDate),e.hasOwnProperty("endDate")&&this.setEndDate(e.endDate),e.hasOwnProperty("selectedPeriod")&&this.setSelectedPeriod(e.selectedPeriod),this.label=OWA.util.sprintf("%s - %s",this.formatYyyymmdd(this.getStartDate(),"/"),this.formatYyyymmdd(this.getEndDate(),"/")),OWA.isJsLoaded("jquery-ui")?this.setupDomElements():OWA.requireJs("jquery-ui",OWA.getOption("modules_url")+"base/js/includes/jquery/jquery-ui-1.8.12.custom.min.js",OWA.requireJs("jqote",OWA.getOption("modules_url")+"base/js/includes/jquery/jQote2/jquery.jqote2.min.js",this.setupDomElements()))},OWA.report.timePeriodControl.prototype={fixedPeriods:{today:"Today",yesterday:"Yesterday",this_week:"This Week",this_month:"This Month",this_year:"This Year",last_week:"Last Week",last_month:"Last Month",last_year:"Last Year",last_seven_days:"Last Seven Days",last_thirty_days:"Last Thirty Days",same_day_last_week:"Same Day Last Week",same_week_last_year:"Same Week Last Year",same_month_last_year:"Same Month Last Year"},setSelectedPeriod:function(t){this.selectedPeriod=t},formatYyyymmdd:function(t,e){e=e||"-";var i=t.substr(2,2);return t.substr(4,2)+e+t.substr(6,2)+e+i},setStartDate:function(t){this.startDate=t},setEndDate:function(t){this.endDate=t},getStartDate:function(){return this.startDate},getEndDate:function(){return this.endDate},isValidDateString:function(t){return 10==t.length&&("-"==t.substr(2,1)&&"-"==t.substr(5,1))},setupDomElements:function(){var t=this,e={periods:this.fixedPeriods,datelabel:this.label,selectedPeriod:this.selectedPeriod};jQuery.get(OWA.getOption("modules_url")+"base/templates/filter_period.php",(function(i){jQuery(t.dom_id).jqoteapp(i,e,"*"),jQuery("#owa_reportPeriodLabelContainer").click((function(){jQuery("#owa_reportPeriodFiltersContainer").toggle()})),jQuery("#owa_report-datepicker-start-display").change((function(){var e=jQuery(this).val();t.isValidDateString(e)?(jQuery("#owa_report-datepicker-start").datepicker("setDate",e),jQuery("#owa_report-datepicker-start").datepicker("option","onSelect")(e)):(alert("Date must be in mm-dd-yyyy format."),jQuery("#owa_report-datepicker-start-display").val(""))})),jQuery("#owa_report-datepicker-end-display").change((function(){var e=jQuery(this).val();t.isValidDateString(e)?(jQuery("#owa_report-datepicker-end").datepicker("setDate",e),jQuery("#owa_report-datepicker-end").datepicker("option","onSelect")(e)):(alert("Date must be in mm-dd-yyyy format."),jQuery("#owa_report-datepicker-end-display").val(""))})),jQuery("#owa_report-datepicker-start").datepicker({dateFormat:"mm-dd-yy",altField:"#owa_report-datepicker-start-display",onSelect:function(t){var e=jQuery("#owa_report-datepicker-start").data("datepicker"),i=jQuery.datepicker.parseDate(e.settings.dateFormat||jQuery.datepicker._defaults.dateFormat,t,e.settings);jQuery("#owa_report-datepicker-end").datepicker("option","minDate",i),jQuery("#owa_report-datepicker-start").datepicker("option","maxDate",jQuery("#owa_report-datepicker-end").datepicker("getDate"))},defaultDate:t.formatYyyymmdd(t.getStartDate())}),jQuery("#owa_report-datepicker-end").datepicker({dateFormat:"mm-dd-yy",altField:"#owa_report-datepicker-end-display",onSelect:function(t){var e=jQuery("#owa_report-datepicker-end").data("datepicker"),i=jQuery.datepicker.parseDate(e.settings.dateFormat||jQuery.datepicker._defaults.dateFormat,t,e.settings);jQuery("#owa_report-datepicker-end").datepicker("option","minDate",jQuery("#owa_report-datepicker-start").datepicker("getDate")),jQuery("#owa_report-datepicker-start").datepicker("option","maxDate",i)},defaultDate:t.formatYyyymmdd(t.getEndDate())}),jQuery("#owa_reportPeriodFilterSubmit").click((function(){jQuery(t.dom_id).trigger("owa_new_time_period_set",[jQuery.datepicker.formatDate("yymmdd",jQuery("#owa_report-datepicker-start").datepicker("getDate")),jQuery.datepicker.formatDate("yymmdd",jQuery("#owa_report-datepicker-end").datepicker("getDate"))])})),jQuery("#owa_reportPeriodFilter").change((function(){var e=jQuery("#owa_reportPeriodFilter option:selected").val();jQuery(t.dom_id).trigger("owa_new_fixed_time_period_set",[e])}))}))}}},function(t,e){OWA.resultSet=function(t){for(attribute in t)this[attribute]=t[attribute]},OWA.resultSet.prototype={getMetricLabel:function(t){return this.aggregates[t].label.length>0?this.aggregates[t].label:"unknown"},getMetricValue:function(t){return this.aggregates[t].value.length>0?this.aggregates[t].value:0},getSeries:function(t,e,i){if(this.resultsRows.length>0){for(var r=[],o=0;o<=this.resultsRows.length-1;o++)if(!i||(check=i(this.resultsRows[o]),check)){var s="";s=e?[this.resultsRows[o][t].value,this.resultsRows[o][e].value]:this.resultsRows[o][t].value,r.push(s)}return r}}},OWA.resultSetExplorer=function(t,e){this.dom_id=t||"",this.gridInit=!1,this.init={grid:!1,pieChart:!1,areaChart:!1},this.columnLinks="",this._columnLinksCount=0,this.resultSet=[],this.currentView="",this.currentContainerWidth="",this.currentWindowWidth="",this.view="",this.asyncQueue=[],this.subscriber_dom_ids=[],this.autoRefreshInterval=1e4,this.autoRefresh=!1,this.autoRefreshTimerId="",this.domSelectors={areaChart:"",grid:""},this.options={defaultView:"grid",areaChart:{series:[],showDots:!0,showLegend:!0,lineWidth:4},pieChart:{metric:"",dimension:"",metrics:[],numSlices:5},sparkline:{metric:""},grid:{showRowNumbers:!0,excludeColumns:[],columnFormatters:{}},template:{template:"",params:"",mode:"append",dom_id:""},metricBoxes:{width:""},chart:{showGrid:!0},chartHeight:125,chartWidth:700,autoResizeCharts:!0,views:["grid","areaChart","pie","sparkline"]},this.viewObjects={},this.loadUrl="",this.dataExportApiParams={},this.isLoaded=!1},OWA.resultSetExplorer.prototype={viewMethods:{grid:"refreshGrid",areaChart:"makeAreaChart",pie:"makePieChart",sparkline:"makeSparkline",template:"renderTemplate"},setDataLoadUrl:function(t){this.loadUrl=t},changeSort:function(t,e){var i=new OWA.uri(this.resultSet.self),r="";"desc"===e&&(r="-"),i.setQueryParam("owa_sort",t+r),i.removeQueryParam("owa_page"),this.getNewResultSet(i.getSource())},changeDimension:function(t,e){var i=new OWA.uri(this.resultSet.self),r=OWA.util.urldecode(i.getQueryParam("owa_dimensions")),o=[];if(r){if(r=r.split(","),OWA.util.in_array(t,r))for(var s=0;s<r.length;s++)r[s]===t?new_dim=e:new_dim=r[s],o.push(new_dim);else(o=r).push(e);o=o.join(","),i.setQueryParam("owa_dimensions",o),this.getNewResultSet(i.getSource())}},changeConstraints:function(t){var e=new OWA.uri(this.resultSet.self);e.setQueryParam("owa_constraints",t),this.getNewResultSet(e.getSource())},getOption:function(t){return this.options[t]},getAggregates:function(){return this.resultSet.aggregates},setView:function(t){this.view=t},setCurrentView:function(t){jQuery(that.domSelectors[that.currentView]).toggle(),this.currentView=t},makeRowGuid:function(t){},getRowValues:function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i].value);return e},loadFromArray:function(t,e){e&&(this.view=e),this.loader(t)},load:function(t){this.showLoader(),t=t||this.loadUrl,this.getResultSet(t)},createGrid:function(t,e){t=t||this.dom_id,e=e||this.options.grid,new OWA.dataGrid(t,e).generate(this.resultSet),this.registerDataChangeSubscriber(t);var i=this;jQuery("#"+t).bind("page_forward",(function(t){i.getNewResultSet(i.resultSet.next)})),jQuery("#"+t).bind("page_back",(function(t){i.getNewResultSet(i.resultSet.previous)})),jQuery("#"+t).bind("secondary_dimension_change",(function(t,e,r){i.changeDimension(e,r)})),jQuery("#"+t).bind("sort_column_change",(function(t,e,r){i.changeSort(e,r)})),jQuery("#"+t).bind("constraint_change",(function(t,e){i.changeConstraints(e)}))},registerDataChangeSubscriber:function(t){this.subscriber_dom_ids.push(t)},refreshGrid:function(){return this.createGrid()},loader:function(t){if(t){if(this.setResultSet(t),this.isLoaded=!0,this.view)this[this.viewMethods[this.view]]();if(this.asyncQueue.length>0)for(var e=0;e<this.asyncQueue.length;e++)this.dynamicFunc(this.asyncQueue[e]);this.autoRefresh&&this.startAutoRefresh()}},enableAutoRefresh:function(t){this.isLoaded?this.startAutoRefresh(t):(this.autoRefreshInterval=t||this.autoRefreshInterval,this.autoRefresh=!0)},startAutoRefresh:function(t){if(this.autoRefreshInterval=t||this.autoRefreshInterval,this.isLoaded&&!this.autoRefreshTimerId){var e=this;this.autoRefreshTimerId=setInterval((function(){e.getNewResultSet()}),this.autoRefreshInterval)}},stopAutoRefresh:function(){clearInterval(this.autoRefreshTimerId),this.autoRefreshTimerId=""},dynamicFunc:function(t){var e=Array.prototype.slice.call(t,1);this[t[0]].apply(this,e)},showLoader:function(){jQuery("#"+this.dom_id).append('<div class="loader"><img class="loading" src="'+OWA.getSetting("baseUrl")+'/modules/base/i/loader.gif"></div>')},hideLoader:function(){jQuery("#"+this.dom_id).find(".loader").remove()},getResultSet:function(t){var e=this;jQuery.getJSON(t,"",(function(t){e.hideLoader(),e.loader(t)}))},getNewResultSet:function(t){t=t||this.resultSet.self;var e=this;jQuery.getJSON(t,"",(function(t){e.setResultSet(t)}))},setResultSet:function(t){if(OWA.util.is_object(t)&&OWA.util.is_object(this.resultSet)){if(t.guid===this.resultSet.guid)return void OWA.debug("result set has same GUID. no change needed.");OWA.debug("result set has new GUID. change needed.")}t.hasOwnProperty("data")?this.resultSet=new OWA.resultSet(t.data):this.resultSet=new OWA.resultSet(t),this.applyLinks();for(var e=0;e<this.subscriber_dom_ids.length;e++)OWA.debug("about to trigger data updates."),jQuery("#"+this.subscriber_dom_ids[e]).trigger("new_result_set",[this.resultSet])},addLinkToColumn:function(t,e,i){if(this.columnLinks={},t){var r={};r.name=t,r.template=e,r.params=i,this.columnLinks[t]=r,r=""}this._columnLinksCount++},applyLinks:function(){if(this.resultSet.resultsRows.length>0&&this._columnLinksCount>0)for(var t=0;t<=this.resultSet.resultsRows.length-1;t++)for(var e in this.columnLinks)if(this.columnLinks.hasOwnProperty(e)){var i=this.columnLinks[e].template;if(this.resultSet.resultsRows[t][e].name.length>0){for(var r in this.columnLinks[e].params)this.columnLinks[e].params.hasOwnProperty(r)&&(i=i.replace("%s",OWA.util.urlEncode(this.resultSet.resultsRows[t][this.columnLinks[e].params[r]].value)));this.resultSet.resultsRows[t][this.columnLinks[e].name].link=i}}},formatValue:function(t,e){switch(t){case"yyyymmdd":var i=1*e.substring(0,4),r=1*e.substring(4,6)-1,o=1*e.substring(6,8),s=Date.UTC(i,r,o,0,0,0,0);e=s,OWA.debug("year: %s, month: %s, day: %s, timestamp: %s",i,r,o,s);break;case"currency":e/=100}return e},timestampFormatter:function(t){var e=new Date(1*t),i=e.getUTCDate();return e.getUTCMonth()+1+"/"+i+"/"+e.getUTCFullYear()},makeAreaChart:function(t,e){var i=new OWA.areaChart;e=e||this.dom_id,i.setDomId(e),i.generate(this.resultSet,t,e),this.registerDataChangeSubscriber(e)},showTooltip:function(t,e,i){jQuery('<div id="tooltip">'+i+"</div>").css({position:"absolute",display:"none",top:e+5,left:t+5,border:"1px solid #cccccc",padding:"2px","background-color":"#ffffff",opacity:.9}).appendTo("body").fadeIn(100)},getMetricLabel:function(t){return this.resultSet.getMetricLabel(t)},getMetricValue:function(t){return this.resultSet.getMetricValue(t)},makePieChart:function(t,e,i){var r=new OWA.pieChart;i||(i=this.options.pieChart),e||(e=this.dom_id),t||(t=this.resultSet),r.generate(t,e,i),this.registerDataChangeSubscriber(e)},renderTemplate:function(t,e,i,r){t=t||this.options.template.template,e=e||this.options.template.params,i=i||this.options.template.mode,r=r||this.options.template.dom_id||this.dom_id,jQuery.jqotetag("*"),"append"===i?jQuery("#"+r).jqoteapp(t,e):"prepend"===i?jQuery("#"+r).jqotepre(t,e):"replace"===i&&jQuery("#"+r).jqotesub(t,e)},getSeries:function(t,e,i){if(this.resultSet.resultsRows.length>0){for(var r=[],o=0;o<=this.resultSet.resultsRows.length-1;o++)if(!i||(check=i(this.resultSet.resultsRows[o]),check)){var s="";s=e?[this.resultSet.resultsRows[o][t].value,this.resultSet.resultsRows[o][e].value]:this.resultSet.resultsRows[o][t].value,r.push(s)}return r}},makeMetricBoxes:function(t,e,i,r,o){var s=new OWA.kpiBox;t||(t=this.dom_id);var n={};e&&(n.template=e),i&&(n.label=i),r&&(n.metrics=r),o&&(n.filter=o),this.options.metricBoxes.width&&(n.width=this.options.metricBoxes.width),s.generate(this.resultSet,t,n),this.registerDataChangeSubscriber(t)},makeSparkLine:function(t,e){t||(t=this.dom_id),(new OWA.sparkline).generate(this.resultSet,t,e),this.registerDataChangeSubscriber(t)},renderResultsRows:function(t,e){if(this.resultSet.resultsRows.length>0){t=t||this.dom_id;var r,o=[];for(var s in this.resultSet.resultsRows[0])this.resultSet.resultsRows[0].hasOwnProperty(s)&&o.push(this.resultSet.resultsRows[0][s]);jQuery.jqotetag("*");var n=jQuery("#simpleTable-headers").jqote(o);for(r=jQuery("#simpleTable-outer").jqote({dom_id:t+"_simpleTable",headers:n}),jQuery("#"+t).html(r),i=0;i<=this.resultSet.resultsRows.length-1;i++){var a="";for(var u in this.resultSet.resultsRows[i])this.resultSet.resultsRows[i].hasOwnProperty(u)&&(a+=jQuery("#table-column").jqote(this.resultSet.resultsRows[i][u]));var l=jQuery("#table-row").jqote({columns:a});jQuery("#"+t+"_simpleTable").append(l)}}else jQuery("#"+t).html("No results to display.")},getApiEndpoint:function(){return this.getOption("api_endpoint")||OWA.getSetting("api_endpoint")},makeApiRequestUrl:function(t,e,i){i=i||this.getApiEndpoint();i+="?",i+="owa_do="+t;OWA.util.countObjectProperties(e);for(option in e)e.hasOwnProperty(option)&&(void 0!==e[option]&&(i+="&owa_"+option+"="+OWA.util.urlEncode(e[option])));return i}},OWA.dimensionPicker=function(t,e){this.dim_list={},this.alternate_field_selector="",this.dom_id=t,this.exclusions=[],e&&e.hasOwnProperty("exclusions")&&this.setExclusions(e.exclusions)},OWA.dimensionPicker.prototype={setDimensions:function(t){this.dim_list=t},reset:function(t){t&&this.setDimensions(t),this.generateDimList()},display:function(t){var e=this.dom_id;jQuery(e).html('<span class="dimensionPicker"></span>'),jQuery(e+" > .dimensionPicker > .dim-list").hide(),this.generateDimList(e+" > .dimensionPicker",t)},setDimensionlist:function(t){this.dim_list=t},generateDimList:function(t,e){var i=t,r='<select data-placeholder="Select..." name="dim-list" class="dim-list" style="width:150px;"><option value=""></option>',o=this;if(OWA.util.countObjectProperties(this.dim_list)>0){for(group in this.dim_list)if(this.dim_list.hasOwnProperty(group)){r+=OWA.util.sprintf('<optgroup label="%s">',group);for(var s=0;s<this.dim_list[group].length;s++)this.exclusions.length>0&&OWA.util.in_array(this.dim_list[group][s].name,this.exclusions)||(r+=OWA.util.sprintf('<option value="%s">%s</option>',this.dim_list[group][s].name,this.dim_list[group][s].label))}}else r+=OWA.l("There are no related dimensions.");jQuery(i).append(r),jQuery(i+" > .dim-list").chosen({no_results_text:"Name not found."}),jQuery(i+" > .dim-list").chosen().change((function(){var e=jQuery(t+" > .dim-list").val();jQuery(o.dom_id).trigger("dimension_change",["",e])})),e&&jQuery(t+" > .dim-list").val(e).trigger("liszt:updated")},setAlternateField:function(t){this.alternate_field_selector=t},setExclusions:function(t){this.exclusions=t}},OWA.dataGrid=function(t,e){this.dom_id=t,this.options=e,this.init=!1,this.gridColumnOrder=[],this.columnLinks="",this.constraintPicker="",this.previousDimensionName=""},OWA.dataGrid.prototype={generate:function(t){OWA.debug("hi from generate");jQuery.extend(jQuery.fn.fmatter,{urlFormatter:function(t,e,i){e.rowId;var r=e.colModel.realColName;if(OWA.debug(e.rowId-1+" "+r),i[r].link.length>0)return'<a href="'+i[r].link+'">'+t.formatted_value+"</a>"},useServerFormatter:function(t,e,i){return i[e.colModel.realColName].formatted_value}}),!0!==this.init?this.display(t):this.refresh(t),jQuery("#load_"+this.dom_id+"_grid").hide(),jQuery("#load_"+this.dom_id+"_grid").css("z-index",101),1==t.page?(jQuery("#"+this.dom_id+" > .owa_resultsExplorerBottomControls > UL > .owa_nextPageControl").show(),jQuery("#"+this.dom_id+" > .owa_resultsExplorerBottomControls > UL > .owa_previousPageControl").hide()):t.page==t.total_pages?(jQuery("#"+this.dom_id+" > .owa_resultsExplorerBottomControls > UL > .owa_nextPageControl").hide(),jQuery("#"+this.dom_id+" > .owa_resultsExplorerBottomControls > UL > .owa_previousPageControl").show()):jQuery("#"+this.dom_id+" > .owa_resultsExplorerBottomControls > UL > .owa_previousPageControl").show()},display:function(t){if(t.resultsReturned>0)this.subscribeToDataUpdates(),this.injectDomElements(t),this.setGridOptions(t),this.addAllRowsToGrid(t),this.makeGridPagination(t),this.init=!0;else{var e=this.dom_id;jQuery("#"+e).html("No data is available for this time period.")}},refresh:function(t){jQuery("#"+this.dom_id+"_grid").jqGrid("GridUnload","#gbox_"+this.dom_id+"_grid"),this.setGridOptions(t),jQuery("#"+this.dom_id+" _grid").jqGrid("clearGridData",!0),this.addAllRowsToGrid(t)},subscribeToDataUpdates:function(){var t=this;jQuery("#"+t.dom_id).bind("new_result_set",(function(e,i){t.generate(i)}))},makeGridPagination:function(t){if(t.more){var e=this,i="";i+='<LI class="owa_previousPageControl">',i+="<span>&laquo</span></LI>",jQuery("#"+e.dom_id+" > .owa_resultsExplorerBottomControls > UL").append(i),jQuery("#"+e.dom_id+" > .owa_resultsExplorerBottomControls > UL > .owa_previousPageControl").button(),jQuery("#"+e.dom_id+" > .owa_resultsExplorerBottomControls > UL > .owa_previousPageControl > .ui-button-text").css("line-height","0.5"),jQuery(".owa_previousPageControl").bind("click",(function(){e.pageGrid("back")}));var r="";r+='<LI class="owa_nextPageControl">',r+="<span>&raquo</span></LI>",jQuery("#"+e.dom_id+" > .owa_resultsExplorerBottomControls > UL").append(r),jQuery("#"+e.dom_id+" > .owa_resultsExplorerBottomControls > UL > .owa_nextPageControl").button(),jQuery("#"+e.dom_id+" > .owa_resultsExplorerBottomControls > UL > .owa_nextPageControl > .ui-button-text").css("line-height","0.5"),jQuery("#"+e.dom_id+" > .owa_resultsExplorerBottomControls > UL > .owa_nextPageControl").bind("click",(function(){e.pageGrid("forward")})),1==t.page&&jQuery("#"+e.dom_id+" > .owa_resultsExplorerBottomControls > UL > .owa_previousPageControl").hide()}},pageGrid:function(t){jQuery("#"+this.dom_id).trigger("page_"+t,[])},addAllRowsToGrid:function(t){jQuery("#load_"+this.dom_id+"_grid").html("Loading..."),jQuery("#load_"+this.dom_id+"_grid").show(),jQuery("#load_"+this.dom_id+"_grid").css("z-index",1e3),jQuery("#"+this.dom_id+"_grid")[0].addJSONData(t),this.displayRowCount(t)},displayRowCount:function(t){if(t.total_pages>1){var e="",i="";1===t.page?(e=1,i=t.resultsReturned):(e=(t.page-1)*t.resultsPerPage+1,i=(t.page-1)*t.resultsPerPage+t.resultsReturned);var r='<li class="owa_rowCount">';r+="Results: "+e+" - "+i,r+="</li>",null===jQuery("#"+this.dom_id+" > .owa_resultsExplorerBottomControls > UL > .owa_rowCount").html()?jQuery("#"+this.dom_id+" > .owa_resultsExplorerBottomControls > UL").append(r):jQuery("#"+this.dom_id+" > .owa_resultsExplorerBottomControls > UL > .owa_rowCount").html(r)}},injectDomElements:function(t){var e="";e+='<div class="owa_genericHorizontalList explorerTopControls"><ul></ul><div style="clear:both;"></div></div>',e+='<div style="clear:both;"></div>',e+='<table id="'+this.dom_id+'_grid"></table>',e+='<div class="owa_genericHorizontalList owa_resultsExplorerBottomControls"><ul></ul></div>',e+='<div style="clear:both;"></div>';var i=this;jQuery("#"+i.dom_id).append(e),jQuery("#"+i.dom_id+" > .explorerTopControls > ul").append(OWA.util.sprintf('<li class="controlItem"><span class="label">%s:</span> <span id="%s"></span></li>',OWA.l("Secondary Dimension"),this.dom_id+"_grid_secondDimensionChooser"));var r=new OWA.dimensionPicker("#"+this.dom_id+"_grid_secondDimensionChooser");r.setExclusions(this.getDimensions(t)),r.setDimensions(t.relatedDimensions),r.display(),jQuery("#"+i.dom_id+"_grid_secondDimensionChooser").bind("dimension_change",(function(t,e,r){jQuery("#"+i.dom_id).trigger("secondary_dimension_change",[i.previousDimensionName,r]),i.previousDimensionName=r})),jQuery("#"+i.dom_id+" > .explorerTopControls > ul").append('<li class="controlItem"><span class="label">Filter:</span> <span class="constraintPicker"></span></li>');var o="#"+this.dom_id+" > .explorerTopControls > ul > .controlItem > .constraintPickerButton",s="#"+this.dom_id+" > .explorerTopControls > ul > .controlItem > .constraintPicker";jQuery(o).button(),this.constraintPicker=new OWA.constraintBuilder(s,{}),this.constraintPicker.setRelatedDimensions(t.relatedDimensions,[]),this.constraintPicker.setRelatedMetrics(t.relatedMetrics,[]);var n=new OWA.uri(t.self).getQueryParam("owa_constraints");this.constraintPicker.display(n),jQuery(s).bind("constraint_change",(function(t,e){jQuery("#"+i.dom_id).trigger("constraint_change",[e])}))},setGridOptions:function(t){var e=this,i=[],r="";for(var o in this.gridColumnOrder=[],t.resultsRows[0])if(this.options.excludeColumns.length>0)for(var s=0;s<=this.options.excludeColumns.length-1;s++)this.options.excludeColumns[s]!=o&&(r=this.makeGridColumnDef(t.resultsRows[0][o]),i.push(r),this.gridColumnOrder.push(t.resultsRows[0][o].name));else r=this.makeGridColumnDef(t.resultsRows[0][o]),i.push(r),this.gridColumnOrder.push(t.resultsRows[0][o].name);jQuery("#"+e.dom_id+"_grid").jqGrid({jsonReader:{repeatitems:!1,root:"resultsRows",cell:"",id:"",page:"page",total:"total_pages",records:"resultsReturned"},afterInsertRow:function(t,e,i){},datatype:"local",colModel:i,rownumbers:e.options.showRowNumbers,viewrecords:!0,rowNum:t.resultsReturned,height:"100%",autowidth:!0,hoverrows:!1,sortname:t.sortColumn,sortorder:t.sortOrder,onSortCol:function(t,i,r){return jQuery("#"+e.dom_id).trigger("sort_column_change",[t,r]),"stop"}});for(var n=0;n<i.length;n++){var a={};"owa_dimensionGridCell"==i[n].classes?a["text-align"]="left":a["text-align"]="right",t.sortColumn,i[n].name,jQuery("#"+e.dom_id+"_grid").jqGrid("setLabel",i[n].name,"",a)}},makeGridColumnDef:function(t){var e="",i="",r="",o="",s="",n=!0,a=!1,u="";return"dimension"===t.result_type?(i="left",o="owa_dimensionGridCell"):(i="right",o="owa_metricGridCell",s=100,n=!1,a=!0),e="string"===t.data_type?"text":"number",r=t.link?"urlFormatter":"useServerFormatter",this.options.columnFormatters.hasOwnProperty(t.name)&&(r=this.options.columnFormatters[t.name]),this.columnLinks.hasOwnProperty(t.name)&&(u=this.columnLinks[t.name].template),{name:t.name,index:t.name+"",label:t.label,sorttype:e,align:i,formatter:r,classes:o,width:s,resizable:n,fixed:a,realColName:t.name,datefmt:"",link_template:u}},getDimensions:function(t){var e=new OWA.uri(t.self);return OWA.util.urldecode(e.getQueryParam("owa_dimensions")).split(",")}},OWA.constraintBuilder=function(t,e){this.dom_selector=t,this.options={},this.constraints={},this.relatedDimensions={},this.relatedMetrics={}},OWA.constraintBuilder.prototype={operators:{"==":"Exactly Matching","!=":"Not Matching",">":"Greater than","<":"Less than","=@":"Contains"},parseConstraintString:function(t){return con_obj={name:"",value:"",operator:""},con_obj},constraintsStringToArray:function(t){var e=[],i=[];if(t){OWA.util.strpos(t,",")?e=t.split(","):e.push(t);for(var r=0;r<e.length;r++)for(operator in this.operators)if(this.operators.hasOwnProperty(operator)&&OWA.util.strpos(e[r],operator)){var o=e[r].split(operator),s={name:o[0],operator:operator,value:o[1]};i.push(s)}}return i},display:function(t){var e=this.constraintsStringToArray(t);this.createConstraintAssembler(e)},createConstraintAssembler:function(t){var e=this;jQuery(e.dom_selector).append('<div class="constraintPickerContainer"></div>');var i=e.dom_selector+" > .constraintPickerContainer";jQuery(i).append('<span class="toggle-button"></span><div class="builder"><ul></ul><div style="clear:both;"></div><div class="add-button"></div><div class="apply-button"></div>');var r=i+" > .toggle-button",o=i+" > .builder";if(jQuery(o).hide(),t.length>0)for(var s=0;s<t.length;s++)this.addNewConstraintRow(o+" > ul",t[s].name,t[s].operator,t[s].value);else this.addNewConstraintRow(o+" > ul");jQuery(r).button({icons:{primary:"ui-icon-blank",secondary:"ui-icon-triangle-1-s"},label:OWA.l("Select...")}).click((function(){jQuery(o).toggle()})),jQuery(o+" > .add-button").button({label:OWA.l("+ Add Filter ")}).click((function(){e.addNewConstraintRow(o+" > ul")})),jQuery(o+" > .apply-button").button({label:OWA.l("Apply")}).click((function(){var t="";jQuery(o+" > ul > li").each((function(e){var i=jQuery(this).children(".constraintDimensionPicker").children(".dimensionPicker").children(".dim-list").val(),r=jQuery(this).children(".constraintOperatorPicker").children(".operator-list").selectmenu("value"),s=jQuery(this).children(".constraintValueField").val();s&&(t+=i+r+s,e<jQuery(o+" > ul > li").length-1&&(t+=","))}));jQuery(e.dom_selector).trigger("constraint_change",[t])}))},setRelatedDimensions:function(t,e){this.relatedDimensions=t},setRelatedMetrics:function(t,e){this.relatedMetrics=t},combineRelatedMetricsWithDimensions:function(){var t=!1,e=!1;if(OWA.util.countObjectProperties(this.relatedDimensions)>0&&(e=!0),OWA.util.countObjectProperties(this.relatedMetrics)>0&&(t=!0),t&&e){var i=this.relatedDimensions;for(metric in this.relatedMetrics)this.relatedMetrics.hasOwnProperty(metric)&&(i[metric]=this.relatedMetrics[metric]);return i}return t?this.relatedMetrics:e?this.relatedDimensions:void 0},addNewConstraintRow:function(t,e,i,r){jQuery(t).append('<LI class="constraintRow"><span class="constraintDimensionPicker"></span> <span class="constraintOperatorPicker"></span><input class="constraintValueField" type="text" size="30"><span class="constraintRemoveButton">X</span></LI>');var o=t+" > li:last > .constraintDimensionPicker",s=new OWA.dimensionPicker(o);s.setDimensions(this.combineRelatedMetricsWithDimensions()),s.display(e),this.makeOperatorPicker(t+" > li:last > .constraintOperatorPicker",i),r&&jQuery(t+" > li:last > .constraintValueField").val(r),jQuery(t+"> li:last > .constraintRemoveButton").button({label:OWA.l("X")}).click((function(){jQuery(this).parent().remove()}))},makeOperatorPicker:function(t,e){var i="";for(operator in i+='<select name="operator-list" class="operator-list">',this.operators)this.operators.hasOwnProperty(operator)&&(i+=OWA.util.sprintf('<option value="%s">%s</option>',operator,this.operators[operator]));i+="</select>",i+="",jQuery(t).append(i),jQuery(t+" > .operator-list").selectmenu({width:200}),e&&jQuery(t+" > .operator-list").selectmenu("value",e)}}},function(t,e){OWA.sparkline=function(t){this.config=OWA.config||"",this.dom_id=t||"",this.data="",this.options={type:"line",lineWidth:2,width:"100px",height:"20px",spotRadius:0,minSpotColor:"#FF0000",maxSpotColor:"#00FF00"}},OWA.sparkline.prototype={mergeOptions:function(t){for(option in t)t.hasOwnProperty(option)&&(this.options[option]=t[option])},setDomId:function(t){this.dom_id=t,this.domSelector=this.dom_id+" > .sparkline";var e=this;jQuery("#"+e.dom_id).bind("new_result_set",(function(t,i){jQuery(e.domSelector).remove(),e.generate(i)}))},getOption:function(t){if(this.options.hasOwnProperty(t))return this.options[t]},setOption:function(t,e){this.options[t]=e},generate:function(t,e,i){e&&this.setDomId(e),e=this.dom_id,i&&this.mergeOptions(i);var r=t.getSeries(this.options.metric,"",this.options.filter);r||(r=[0,0,0]);this.domSelector;jQuery("#"+e).append('<p class="sparkline"></p>'),this.loadFromArray(r)},render:function(){jQuery("#"+this.dom_id).sparkline("html",this.options)},loadFromArray:function(t){var e="#"+this.domSelector;jQuery(e).sparkline(t,this.options)},setHeight:function(t){this.options.height=t},setWidth:function(t){this.options.width=t}}},function(t,e){OWA.areaChart=function(t){if(this.options={series:[],height:125,width:"99%",xaxis:{mode:"time"},timeformat:"%m/%d",showGrid:!0,showLegend:!0,showDots:!0,lineWidth:4,autoResizeCharts:!0,fillColor:"rgba(202,225,255, 0.6)",colors:["#1874CD","#dba255","#919733"]},t)for(option in t)t.hasOwnProperty(option)&&(this.options[option]=t[option]);this.dom_id="",this.domSelector="",this.init=!1},OWA.areaChart.prototype={setDomId:function(t){this.dom_id=t,this.domSelector="#"+t+" > .owa_areaChart";var e=this;jQuery("#"+e.dom_id).bind("new_result_set",(function(t,i){e.generate(i)}))},getOption:function(t){if(this.options.hasOwnProperty(t))return this.options[t]},setOption:function(t,e){this.options[t]=e},getContainerHeight:function(){return jQuery("#"+this.dom_id).height()},formatValue:function(t,e){switch(t){case"yyyymmdd":var i=1*e.substring(0,4),r=1*e.substring(4,6)-1,o=1*e.substring(6,8),s=Date.UTC(i,r,o,0,0,0,0);e=s,OWA.debug("year: %s, month: %s, day: %s, timestamp: %s",i,r,o,s);break;case"currency":e/=100}return e},timestampFormatter:function(t){var e=new Date(1*t),i=e.getUTCDate();return e.getUTCMonth()+1+"/"+i+"/"+e.getUTCFullYear()},generate:function(t,e,i){OWA.debug("generating area chart for "+i),i&&this.setDomId(i),i=this.dom_id,e&&(this.options.series=e);var r=this.domSelector;if(jQuery(r).remove(),t.resultsRows.length>0){var o=[];e=this.options.series;for(var s=[],n=0;n<=e.length-1;n++){for(var a=e[n].x,u=e[n].y,l=0;l<=t.resultsRows.length-1;l++){data_type_x=t.resultsRows[l][a].data_type,data_type_y=t.resultsRows[l][u].data_type;var h=[this.formatValue(data_type_x,t.resultsRows[l][a].value),this.formatValue(data_type_y,t.resultsRows[l][u].value)];s.push(h)}var d=t.getMetricLabel(u);o.push({label:d,data:s})}OWA.debug("ac init not set"),this.setupAreaChart(e,i);var c=s.length;s.length>10&&(c=10);var p={yaxis:{tickDecimals:0},xaxis:{ticks:c,tickDecimals:null},grid:{show:this.options.showGrid,hoverable:!0,autoHilight:!0,borderWidth:0,borderColor:null},series:{points:{show:this.options.showDots,fill:this.options.showDots},lines:{show:!0,fill:!0,fillColor:this.options.fillColor,lineWidth:this.options.lineWidth}},colors:this.options.colors,legend:{position:"ne",margin:[0,-10],show:this.options.showLegend}};"yyyymmdd"===data_type_x&&(p.xaxis.mode="time",p.xaxis.timeformat=this.options.timeformat),OWA.debug("Plotting area graph in "+r);var f=jQuery(r);jQuery.plot(f,o,p),this.init=!0}else jQuery("#"+i).html("No data is available for this time period"),jQuery("#"+i).css("height","50px")},showTooltip:function(t,e,i){jQuery('<div id="tooltip">'+i+"</div>").css({position:"absolute",display:"none",top:e+5,left:t+5,border:"1px solid #cccccc",padding:"2px","background-color":"#ffffff",opacity:.9}).appendTo("body").fadeIn(100)},setupAreaChart:function(t,e){e=e||this.dom_id;var i=this,r=(jQuery("#"+e).css("width"),this.getContainerHeight()||this.getOption("height"));jQuery("#"+e).html('<div class="owa_areaChart"></div>'),jQuery(i.domSelector).css("width",this.getOption("width")),jQuery(i.domSelector).css("height",r);var o=null;jQuery(i.domSelector).bind("plothover",(function(t,e,r){if(jQuery("#x").text(e.x.toFixed(2)),jQuery("#y").text(e.y.toFixed(2)),r){if(o!=r.datapoint){o=r.datapoint,jQuery("#tooltip").remove();var s=r.datapoint[0].toFixed(0),n=r.datapoint[1].toFixed(0);"time"===i.options.xaxis.mode&&(s=i.timestampFormatter(s)),i.showTooltip(r.pageX-75,r.pageY-50,s+"<BR><B>"+r.series.label+":</B> "+n)}}else jQuery("#tooltip").remove(),o=null}))}}},function(t,e){OWA.pieChart=function(t){this.options={height:200,width:200,metric:"",dimension:"",metrics:[],numSlices:5,showGrid:!0,showDots:!0,showLegend:!0,autoSizeWidth:!0},t&&this.mergeOptions(t),this.dom_id="",this.domSelector=""},OWA.pieChart.prototype={mergeOptions:function(t){for(option in t)t.hasOwnProperty(option)&&(this.options[option]=t[option])},setDomId:function(t){this.dom_id=t,this.domSelector="#"+this.dom_id+" > .owa_pieChart";var e=this;jQuery("#"+e.dom_id).bind("new_result_set",(function(t,i){e.generate(i)}))},getOption:function(t){if(this.options.hasOwnProperty(t))return this.options[t]},setOption:function(t,e){this.options[t]=e},formatValue:function(t,e){switch(t){case"yyyymmdd":var i=1*e.substring(0,4),r=1*e.substring(4,6)-1,o=1*e.substring(6,8),s=Date.UTC(i,r,o,0,0,0,0);e=s,OWA.debug("year: %s, month: %s, day: %s, timestamp: %s",i,r,o,s);break;case"currency":e/=100}return e},setupPieChart:function(){var t=this.getContainerWidth(),e=this.getContainerWidth();jQuery("#"+this.dom_id).append('<div class="owa_pieChart"></div>'),jQuery(this.domSelector).css("width",t),jQuery(this.domSelector).css("height",e)},generate:function(t,e,i){OWA.debug("generating pie chart"),e&&this.setDomId(e),e=this.dom_id,i&&this.mergeOptions(i);var r=this.domSelector,o=[],s=0;if(this.options.dimension.length>0)if(t.resultsRows.length>0){var n=this.options.dimension,a=this.options.numSlices,u=this.options.metric,l=0;l=a>t.resultsRows.length?t.resultsRows.length:a;for(var h=0;h<=l-1;h++){var d={label:t.resultsRows[h][n].value,data:1*t.resultsRows[h][u].value};o.push(d),s+=t.resultsRows[h][u].value}if(t.resultsRows.length>l){var c=t.aggregates[u]-s;o.push({label:"others",data:c})}}else jQuery("#"+this.dom_id).append("No data is available for this time period"),jQuery("#"+this.dom_id).css("height","50px");else if(jQuery.isEmptyObject(t.aggregates))jQuery("#"+this.dom_id).append("No data is available for this time period"),jQuery("#"+this.dom_id).css("height","50px");else for(var p=this.options.metrics,f=0;f<=p.length-1;f++){var m=1*t.aggregates[p[f]].value;o.push({label:t.getMetricLabel(p[f]),data:m})}this.init||this.setupPieChart();OWA.debug(JSON.stringify(o)),jQuery.plot(jQuery(r),o,{series:{pie:{show:!0,showLabel:!0}},legend:{show:!1,position:"ne",margin:[-160,50]},colors:["#6BAED6","#FD8D3C","#dba255","#919733"]}),this.init=!0},getContainerWidth:function(){return this.getOption("autoSizeWidth")?jQuery("#"+this.dom_id).width():this.option.width},getContainerHeight:function(){return jQuery("#"+this.dom_id).height()}}},function(t,e){OWA.kpiBox=function(t){this.options={template:"#metricInfobox",width:""},t&&this.mergeOptions(t),this.dom_id="",this.domSelector=""},OWA.kpiBox.prototype={mergeOptions:function(t){for(option in t)t.hasOwnProperty(option)&&(this.options[option]=t[option])},setDomId:function(t){this.dom_id=t,this.domSelector=this.dom_id+" > .metricInfoboxesContainer";var e=this;jQuery("#"+e.dom_id).bind("new_result_set",(function(t,i){jQuery(e.domSelector).remove(),e.generate(i)}))},getOption:function(t){if(this.options.hasOwnProperty(t))return this.options[t]},setOption:function(t,e){this.options[t]=e},generate:function(t,e,i){OWA.debug("Generating KPI box for: "+e+" with options: "+JSON.stringify(i)),e&&this.setDomId(e),e=this.dom_id,i&&this.mergeOptions(i);var r="",o="kpiContainer-"+t.guid;for(var s in jQuery("#"+e).append(OWA.util.sprintf('<div id="%s" class="metricInfoboxesContainer" style="width:auto;"></div><div style="clear:both;"></div>',o)),t.aggregates)if(t.aggregates.hasOwnProperty(s)){var n=t.aggregates[s];n.dom_id=e+"-"+t.aggregates[s].name+"-"+t.guid,this.options.label&&(n.label=this.options.label),this.options.width&&(n.width=this.options.width);this.domSelector;var a=n.width||"auto";r=OWA.util.sprintf('<div id ="%s" class="owa_metricInfobox" style="min-width:135px;width:%s">',n.dom_id,a);r+=OWA.util.sprintf('<p class="owa_metricInfoboxLabel">%s</p>',n.label),r+=OWA.util.sprintf('<p class="owa_metricInfoboxLargeNumber">%s</p>',n.formatted_value),r+="</div>",jQuery("#"+o).append(r);var u={metric:t.aggregates[s].name,filter:""};this.options.filter&&(u.filter=this.options.filter),(new OWA.sparkline).generate(t,n.dom_id,u)}}}}]);