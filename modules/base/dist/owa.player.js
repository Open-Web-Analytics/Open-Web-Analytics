"use strict";(self.webpackChunkowa=self.webpackChunkowa||[]).push([[200],{993:(e,t,o)=>{o.r(t),o.d(t,{Player:()=>l});var a=o(841),s=o(755);o(901);
/**
 * Domstream Player
 * 
 * @author      Peter Adams <peter@openwebanalytics.com>
 * @web            <a href="http://www.openwebanalytcs.com">Open Web Analytics</a>
 * @copyright   Copyright &copy; 2006-2010 Peter Adams <peter@openwebanalytics.com>
 * @license     http://www.gnu.org/copyleft/gpl.html GPL v2.0
 */
class l{construct(){this.timer=null,this.queue_step=1,this.queue_count=0,this.animateInterval=250,this.stream=null,this.lock=!1,a._.debug("hello from player"),a._.registerStateStore("overlay","","","json")}init(){this.fetchData(),this.showPlayerControls()}block(){this.lock=!0}unblock(){this.lock=!1}load(e){this.stream=e.data,this.queue_count=this.stream.events.length}fetchData(){var e=unescape(a._.state.getStateFromCookie("overlay")),t=JSON.parse(e).api_url,o=this;s.ajax({url:t,dataType:"jsonp",jsonp:"owa_jsonpCallback",success:function(e){o.load(e)}})}moveCursor(e,t){var o=this;this.block(),s("#owa-cursor").animate({top:t+"px",left:e+"px"},{queue:!0,duration:100,complete:function(){o.unblock()}},"swing"),this.setStatus("Mouse Movement to: "+e+", "+t)}scrollViewport(e,t){window.scroll(0,t),this.setStatus("Scrolling to: "+t)}start(){var e=this;this.timer=setInterval((function(){e.step()}),this.animateInterval)}step(){if(this.lock)a._.debug("Can not step as player is locked");else if(0===this.queue_count)this.stop();else if(this.queue_count>0&&this.queue_step>=this.queue_count)this.stop();else{var e=this.getNextEvent();this.playEvent(e)}}getNextEvent(){a._.debug("Queue step is: "+this.queue_step);var e=this.stream.events[this.queue_step];return a._.debug("getting event... "+e.event_type),this.queue_step++,e}playEvent(e){switch(a._.debug("playing event of type: "+e.event_type),e.event_type){case"dom.movement":return this.movementEventHandler(e);case"dom.scroll":return this.scrollEventHandler(e);case"dom.keypress":return this.keypressEventHandler(e);case"dom.click":return this.clickEventHandler(e)}}stop(){if(s("#owa_overlay_start").removeClass("active"),!this.timer)return!1;clearInterval(this.timer),this.setStatus("Ready.")}play(){a._.debug("Now playing Domstream."),(this.queue_step=this.queue_count)&&(this.queue_step=1),this.start(),this.setStatus("Playing...")}showPlayerControls(){s("body").append('<div id="owa_overlay"></div>'),s("#owa_overlay").append('<div id="owa_overlay_logo"></div>');s("#owa_overlay").append('<div class="owa_overlay_control" id="owa_player_start">Play</div>');s("#owa_overlay").append('<div class="owa_overlay_control" id="owa_player_stop">Pause</div>');s("#owa_overlay").append('<div class="owa_overlay_control" id="owa_player_close">Hide</div>');s("#owa_overlay").append('<div id="owa-overlay-status">...</div>');s("body").append('<div id="owa_overlay_hidden"></div>'),s("#owa_overlay_hidden").hide();var e='<div id="owa-cursor"><img src="'+a._.getSetting("baseUrl")+'/modules/base/i/cursor2.png"></div>';s("body").append(e),s("#owa_overlay_start").toggleClass("active"),s(".owa_overlay_control").click((function(){s(".owa_overlay_control").removeClass("active"),s(this).addClass("active")})),s("#owa_overlay_logo").click((function(){s("#owa_overlay").slideToggle("fast"),s("#owa_overlay_hidden").fadeIn("slow")})),s("#owa_overlay_hidden").click((function(){s("#owa_overlay").slideToggle("fast"),s("#owa_overlay_hidden").fadeOut()}));var t=this;s("#owa_player_start").bind("click",(function(e){t.play(e)})),s("#owa_player_stop").bind("click",(function(e){t.stop(e)})),s("#owa_player_close").click((function(){s("#owa_overlay").slideToggle("fast"),s("#owa_overlay_hidden").fadeIn("slow")})),s(window).on("unload",(function(){a._.endOverlaySession()}))}setStatus(e){s("#owa-overlay-status").html(e)}showNotification(e,t){s.jGrowl.defaults.position="center",s.jGrowl.defaults.closer=!1,s.jGrowl.defaults.pool=1,s.jGrowl(e,{life:250,speed:25,position:"center",closer:!1,header:t})}movementEventHandler(e){return this.moveCursor(e.cursor_x,e.cursor_y)}scrollEventHandler(e){this.scrollViewport(e.x,e.y)}keypressEventHandler(e){if(""!=e.dom_element_id)var t="#"+e.dom_element_id;else if(e.dom_element_name)t=e.dom_element_tag+"[name="+e.dom_element_name+"]";var o=s(t).val()||"";o+=e.key_value,s(t).val(o),this.showNotification(e.key_value,"Key Press:"),this.setStatus("Key Press: "+e.key_value)}clickEventHandler(e){var t="";if(""!=e.dom_element_id&&"(not set)"!=e.dom_element_id)var o=t="#"+e.dom_element_id;else if(""!=e.dom_element_name&&"(not set)"!=e.dom_element_name)o=t=e.dom_element_tag+"[name="+e.dom_element_name+"]";else if(""!=e.dom_element_class&&"(not set)"!=e.dom_element_class)o=e.dom_element_tag+"."+e.dom_element_class;else o=e.dom_element_tag;s("#owa_overlay").hide();var a=document.elementFromPoint(e.click_x,e.click_y);s("#owa_overlay").show(),a?a.click():t&&(s(t).click(),s(t).focus());var l="owa-click-marker_"+(new Date).getTime()+1,i='<div id="'+l+'" class="owa-click-marker"></div>';s("body").append(i),s("#"+l).css({position:"absolute",left:e.click_x+"px",top:e.click_y+"px","z-index":89}),this.setStatus("Click @ "+e.click_x+", "+e.click_y),this.showNotification(o,"Clicked On DOM Element:")}}}}]);